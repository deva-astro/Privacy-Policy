<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>WebSocket and Upload Counts Viewer</title><style>body{font-family:Arial,sans-serif;background-color:#282c34;color:white;padding:20px;margin:0;display:flex;flex-direction:row;justify-content:space-between;gap:20px;}#log-container{display:flex;flex-direction:column;gap:20px;flex:1;}.console{width:100%;height:250px;background-color:#1e1e1e;border:1px solid #ccc;padding:10px;overflow-y:auto;color:lightgreen;font-family:monospace;box-shadow:0 0 10px rgba(0,255,0,0.5);box-sizing:border-box;}#upload-counts{font-size:0.9em;border:1px solid #444;padding:10px;width:220px;height:521px;overflow-y:auto;background-color:#333;color:white;box-sizing:border-box;}#device-counts{border:1px solid #444;padding:10px;width:195px;height:490px;overflow-y:auto;background-color:#333;color:white;box-sizing:border-box;}.file-entry{margin-bottom:10px;display:flex;justify-content:space-between;}.danger-log{color:red;font-weight:bold;}.console-title{font-weight:bold;margin-bottom:10px;font-size:1.3em;}@media (max-width:768px){body{flex-direction:column;padding:10px;}#log-container{flex-direction:column;}.console{height:200px;}#upload-counts{width:100%;height:auto;}.file-entry{flex-direction:column;align-items:flex-start;}}</style></head><body><div id="log-container"><div id="danger-log" class="console"><div class="console-title">DANGER Logs</div></div><div id="general-log" class="console"><div class="console-title">WebSocket Logs</div></div></div><div id="upload-counts"><div id="device-counts" class="console"><div class="console-title">Device Upload Counts</div></div></div><script>const ws=new WebSocket('ws://3.107.29.246/weeesx');function updateDeviceUploadCount(deviceName,emailCount){const deviceEntry=document.getElementById(`count-${deviceName}`);if(!deviceEntry){const newEntry=document.createElement('div');newEntry.id=`count-${deviceName}`;newEntry.classList.add('file-entry');newEntry.innerHTML=`<span>${deviceName}: Total: <span id="total-${deviceName}">${emailCount}</span></span>`;document.getElementById('device-counts').appendChild(newEntry);}else{const totalElement=deviceEntry.querySelector(`#total-${deviceName}`);totalElement.textContent=parseInt(totalElement.textContent)+emailCount;}}function scrollToBottom(element){element.scrollTop=element.scrollHeight;}ws.onmessage=function(event){const generalLog=document.getElementById('general-log');const dangerLog=document.getElementById('danger-log');const newLog=document.createElement('div');newLog.textContent=event.data;generalLog.appendChild(newLog);scrollToBottom(generalLog);const logPattern=/Saved (\d+) emails to (\w+)\./;const match=event.data.match(logPattern);if(match){const emailCount=parseInt(match[1]);const deviceName=match[2];updateDeviceUploadCount(deviceName,emailCount);}if(event.data.includes("DANGER-LOG")){newLog.classList.add('danger-log');dangerLog.appendChild(newLog);scrollToBottom(dangerLog);}else{generalLog.appendChild(newLog);scrollToBottom(generalLog);}};ws.onopen=function(){console.log("WebSocket connection opened");};ws.onclose=function(){console.log("WebSocket connection closed");};ws.onerror=function(error){console.error("WebSocket error:",error);};</script></body></html>
